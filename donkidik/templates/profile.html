<!doctype html>
<html ng-app="donkidik">
<head>
	<title>donkidik</title>
	<base href="/../../">
	<link rel="stylesheet" href="static/semantic/dist/semantic.min.css">
	<link rel="stylesheet" href="/static/css/post.css">
	<script type="text/javascript" src="http://ajax.googleapis.com/ajax/libs/angularjs/1.3.1/angular.min.js"></script>
	<script type="text/javascript" src="static/angular/JSONfixer.js"></script>
	<script type="text/javascript" src="static/angular/postsService.js"></script>
	<!--script type="text/javascript" src="/../../static/angular/PostsPageController.js"></script-->
	<script type="text/javascript">
		(function(){
			angular.module('donkidik')
				.controller("profileController", function($scope, postService){
					$scope.posts = [];
					$scope.posts_loaded=false;

					$scope.get_posts = function(uid){
						$scope.posts = [];
						postService.get_posts(uid).then(function(res){
							if (res.success) {
								$scope.posts = res.posts;
								$scope.posts_loaded = true;
							}
							else {
								//TODO: replace loading with error message
								alert('Error getting posts...');
							}
						});
					};
					$scope.get_posts({{uid}});
				});
		})();
	</script>
	<script type="text/javascript" src="static/angular/generalDirectives.js"></script>
	<style type="text/css">
		*{outline:none !important;}
		body{padding:0;margin:0;}
		#main{position: relative;width:550px;margin:0 auto;padding:50px 0;}
		#main > h1{text-align:center;}
	</style> 
</head>
<body>
	<div id="main" ng-controller="profileController">
		<h1>DonkiDik</h1> 
		<form action="/api/user/{{uid}}/change_avatar/" method="post" enctype = "multipart/form-data">
			<input type="file" name="avatar" />
			<input type="submit" value="save" />
		</form>
		<div class="posts">
			<div class="loading" ng-show="!posts_loaded">
				Loading Posts...
			</div>
			<ul ng-show="posts_loaded">
				<post-dir ng-repeat="post in posts" data="post"></post-dir>
			</ul>
		</div>
	</div>
</body>
</html>